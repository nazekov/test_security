<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<body>
    <h1>Добро пожаловать в Бан панель</h1>
    <p>Вы вошли, как</p>
    <span th:text="${#authentication.name}"></span>
    <form th:object="${blockedRequisite}"
          method="post"
          th:action="@{'/black-list/' + ${#authentication.name} + '/ban'}">
        <p>
            Номер реквизита пользователя
            <input type="text" name="requisite" th:field="${blockedRequisite.requisite}"/>
        </p>
        <p>
            <label for="comment">Комментарий. Почему Вы желаете забанить пользователя</label>
            <input type="text" th:field="*{comment}" id="comment" name="comment" placeholder="Комментарий">
        </p>
        <p>При какой услуге произошло мошенничество:</p>
        <select name="service" th:field="*{serviceId}" required="required">
            <option value="">Выберите услугу</option>
            <option value="MOBILE_CONNECTIONS">Мобильная связь</option>
            <option value="INTERNET">Интернет</option>
            <option value="UTILITY_PAYMENTS">Коммунальные платежи</option>
            <option value="TAXES">Налоги</option>
        </select>
        <button type="submit">Забанить</button>
    </form>

    <h2 style="margin: 50px 50px">
        Черный список
    </h2>
    <table class="table table-bordered">
        <thead>
        <tr>
<!--            <th>Id</th>-->
            <th>Номер реквизита</th>
            <th>Сервис</th>
            <th>Статус</th>
            <th>Дата создания</th>
            <th>Кем создан</th>
            <th>Дата обновления</th>
            <th>Кем обновлен</th>
            <th>Комментарий</th>
            <th>Действие</th>
        </tr>
        </thead>
        <tbody>
        <!--/*@thymesVar id="blockedRequisiteList" type="com.example.test_security.model.BlockedRequisite"*/-->
        <tr th:each="blockedRequisite : ${blockedRequisiteList}">
<!--            <td th:text="${blockedRequisite.id}"></td>-->
            <td th:text="${blockedRequisite.requisite}"></td>
            <td th:text="${blockedRequisite.serviceId}"></td>
            <td th:text="${blockedRequisite.status}"></td>
            <td th:text="${blockedRequisite.createdDate}"></td>
            <td th:text="${blockedRequisite.createdBy.username}"></td>
            <td th:text="${blockedRequisite.updatedDate}"></td>
            <td th:text="${blockedRequisite.updatedBy} ? ${blockedRequisite.updatedBy.username} : '----'"></td>
            <td th:text="${blockedRequisite.comment}"></td>
            <td>
                <p th:if="${blockedRequisite.status == blockedRequisite.status.ACTIVE}">
                    <a th:if="${#authentication.isAuthenticated()}" th:href="@{'/black-list/' + ${#authentication.name} + '/ban/' + ${blockedRequisite.requisite}}" style="color: crimson">Забанить</a>
                </p>
                <p th:if="${blockedRequisite.status == blockedRequisite.status.BANNED}">
                    <a th:if="${#authentication.isAuthenticated()}" th:href="@{'/black-list/' + ${#authentication.name} + '/unban/' + ${blockedRequisite.requisite}}" style="color: darkgreen">Разбанить</a>
                </p>
            </td>
        </tr>
        </tbody>
    </table>

    <div>
        <a href="/logout">Выйти из системы</a>
    </div>
</body>
</html>